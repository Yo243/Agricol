import{a as T,c as de,d as se,e as ce,f as K,g as Q}from"./chunk-YSNX2PDW.js";import{b as oe,d as re,e as le}from"./chunk-YAFIELCV.js";import{b as H,d as L,e as G,f as j,g as B,h as W,i as N,m as R,n as q,o as Y,p as U,q as X,t as J}from"./chunk-B4I6E7XD.js";import{$a as v,Ga as O,Ka as x,Q as S,Ra as c,Sa as e,Ta as n,Tb as F,Ua as s,Ub as E,V as u,Vb as k,W as _,X as m,Y as g,Zb as I,_a as y,bb as p,ec as A,ib as w,kb as a,lb as h,mb as b,nb as V,ob as D,pb as C,qa as r,qb as M,rb as P,va as z,vb as ae}from"./chunk-PCLR6J3H.js";import"./chunk-FDERIQAA.js";function ge(o,i){o&1&&(e(0,"div",12),m(),e(1,"svg",13),s(2,"circle",14)(3,"path",15),n(),g(),e(4,"p",16),a(5,"Cargando datos..."),n()())}function fe(o,i){if(o&1&&(e(0,"option",58),a(1),n()),o&2){let t=i.$implicit;c("value",t.id),r(),V(" ",t.nombre," (",t.superficieHa," ha) ")}}function ue(o,i){if(o&1&&(e(0,"option",58),a(1),n()),o&2){let t=i.$implicit;c("value",t.id),r(),b(" ",t.nombre," ")}}function _e(o,i){o&1&&(m(),e(0,"svg",54),s(1,"path",59),n())}function he(o,i){o&1&&(m(),e(0,"svg",60),s(1,"circle",14)(2,"path",15),n())}function xe(o,i){if(o&1){let t=y();e(0,"form",17),v("ngSubmit",function(){u(t);let l=p();return _(l.guardar())}),e(1,"div",18)(2,"div",19)(3,"div",20),a(4,"1"),n(),e(5,"h3",21),a(6,"Informaci\xF3n General"),n()(),e(7,"div",22)(8,"div",23)(9,"label",24),m(),e(10,"svg",25),s(11,"path",26),n(),a(12," Seleccionar Parcela "),g(),e(13,"span",27),a(14,"*"),n()(),e(15,"div",28)(16,"select",29),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.parcelaId,l)||(f.formData.parcelaId=l),_(l)}),v("ngModelChange",function(){u(t);let l=p();return _(l.onParcelaChange())}),e(17,"option",30),a(18,"Seleccionar parcela..."),n(),x(19,fe,2,3,"option",31),n(),m(),e(20,"svg",32),s(21,"path",33),n()()(),g(),e(22,"div",23)(23,"label",24),m(),e(24,"svg",25),s(25,"path",5),n(),a(26," Tipo de Cultivo "),g(),e(27,"span",27),a(28,"*"),n()(),e(29,"div",28)(30,"select",34),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.cultivoId,l)||(f.formData.cultivoId=l),_(l)}),v("ngModelChange",function(){u(t);let l=p();return _(l.onCultivoChange())}),e(31,"option",30),a(32,"Seleccionar cultivo..."),n(),x(33,ue,2,2,"option",31),n(),m(),e(34,"svg",32),s(35,"path",33),n()()()()(),g(),e(36,"div",18)(37,"div",19)(38,"div",20),a(39,"2"),n(),e(40,"h3",21),a(41,"Fechas y Superficie"),n()(),e(42,"div",35)(43,"div",23)(44,"label",24),m(),e(45,"svg",25),s(46,"path",36),n(),a(47," Fecha de Inicio "),g(),e(48,"span",27),a(49,"*"),n()(),e(50,"input",37),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.fechaInicio,l)||(f.formData.fechaInicio=l),_(l)}),n()(),e(51,"div",23)(52,"label",24),m(),e(53,"svg",25),s(54,"path",36),n(),a(55," Cosecha Esperada "),n(),g(),e(56,"input",38),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.fechaCosechaEsperada,l)||(f.formData.fechaCosechaEsperada=l),_(l)}),n()(),e(57,"div",23)(58,"label",24),m(),e(59,"svg",25),s(60,"path",39),n(),a(61," Hect\xE1reas a Sembrar "),g(),e(62,"span",27),a(63,"*"),n()(),e(64,"div",40)(65,"input",41),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.hectareasSembradas,l)||(f.formData.hectareasSembradas=l),_(l)}),n(),e(66,"span",42),a(67,"ha"),n()()()()(),e(68,"div",18)(69,"div",19)(70,"div",20),a(71,"3"),n(),e(72,"h3",21),a(73,"Rendimiento Esperado"),n()(),e(74,"div",23)(75,"label",24),m(),e(76,"svg",25),s(77,"path",43),n(),a(78," Rendimiento Esperado (toneladas) "),n(),g(),e(79,"div",40)(80,"input",44),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.rendimientoEsperado,l)||(f.formData.rendimientoEsperado=l),_(l)}),n(),e(81,"span",42),a(82,"ton"),n()(),e(83,"div",45),m(),e(84,"svg",46),s(85,"path",47),n(),g(),e(86,"p",48),a(87,"Este valor se calcula autom\xE1ticamente seg\xFAn el cultivo seleccionado. Puedes ajustarlo manualmente."),n()()()(),e(88,"div",18)(89,"div",19)(90,"div",20),a(91,"4"),n(),e(92,"h3",21),a(93,"Notas y Observaciones"),n()(),e(94,"div",23)(95,"label",24),m(),e(96,"svg",25),s(97,"path",49),n(),a(98," Observaciones del Per\xEDodo "),n(),g(),e(99,"textarea",50),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.observaciones,l)||(f.formData.observaciones=l),_(l)}),n(),e(100,"p",51),a(101,"Opcional - Informaci\xF3n adicional sobre el per\xEDodo de siembra"),n()()(),e(102,"div",52)(103,"button",53),v("click",function(){u(t);let l=p();return _(l.cerrar())}),m(),e(104,"svg",54),s(105,"path",9),n(),g(),e(106,"span"),a(107,"Cancelar"),n()(),e(108,"button",55),x(109,_e,2,0,"svg",56)(110,he,3,0,"svg",57),e(111,"span"),a(112),n()()()()}if(o&2){let t=p();r(16),w("form-input-disabled",!!t.parcelaId),C("ngModel",t.formData.parcelaId),c("disabled",!!t.parcelaId),r(3),c("ngForOf",t.parcelas),r(11),C("ngModel",t.formData.cultivoId),r(3),c("ngForOf",t.cultivos),r(17),C("ngModel",t.formData.fechaInicio),r(6),C("ngModel",t.formData.fechaCosechaEsperada),r(9),C("ngModel",t.formData.hectareasSembradas),r(15),C("ngModel",t.formData.rendimientoEsperado),r(19),C("ngModel",t.formData.observaciones),r(9),c("disabled",t.loading),r(),c("ngIf",!t.loading),r(),c("ngIf",t.loading),r(2),h(t.loading?"Guardando...":"Iniciar Per\xEDodo")}}var Z=class o{parcelasService=S(T);http=S(A);parcelaId;onClose=new z;onSave=new z;parcelas=[];cultivos=[];loading=!1;loadingData=!1;formData={parcelaId:0,cultivoId:0,fechaInicio:new Date().toISOString().split("T")[0],hectareasSembradas:0,rendimientoEsperado:0,observaciones:""};ngOnInit(){this.cargarDatos(),this.parcelaId&&(this.formData.parcelaId=this.parcelaId)}cargarDatos(){this.loadingData=!0,this.parcelasService.getParcelas(!0,"Activa").subscribe({next:i=>{this.parcelas=i},error:i=>console.error("Error al cargar parcelas:",i)}),this.http.get("http://localhost:3000/api/cultivos").subscribe({next:i=>{this.cultivos=i,this.loadingData=!1},error:i=>{console.error("Error al cargar cultivos:",i),this.loadingData=!1}})}onParcelaChange(){let i=this.parcelas.find(t=>t.id===this.formData.parcelaId);i&&this.formData.hectareasSembradas===0&&(this.formData.hectareasSembradas=i.superficieHa)}onCultivoChange(){let i=this.cultivos.find(t=>t.id===this.formData.cultivoId);if(i&&(this.formData.rendimientoEsperado=i.rendimientoEsperado?i.rendimientoEsperado*this.formData.hectareasSembradas:0,i.diasCiclo)){let t=new Date(this.formData.fechaInicio);t.setDate(t.getDate()+i.diasCiclo),this.formData.fechaCosechaEsperada=t.toISOString().split("T")[0]}}guardar(){this.validarFormulario()&&(this.loading=!0,this.parcelasService.createPeriodoSiembra(this.formData).subscribe({next:()=>{alert("Per\xEDodo de siembra creado correctamente"),this.onSave.emit(),this.cerrar()},error:i=>{console.error("Error al crear per\xEDodo:",i),alert("Error al crear el per\xEDodo de siembra"),this.loading=!1}}))}validarFormulario(){if(!this.formData.parcelaId)return alert("Selecciona una parcela"),!1;if(!this.formData.cultivoId)return alert("Selecciona un cultivo"),!1;if(this.formData.hectareasSembradas<=0)return alert("Las hect\xE1reas sembradas deben ser mayor a 0"),!1;let i=this.parcelas.find(t=>t.id===this.formData.parcelaId);return i&&this.formData.hectareasSembradas>i.superficieHa?(alert(`Las hect\xE1reas sembradas no pueden ser mayor a ${i.superficieHa} ha`),!1):!0}cerrar(){this.onClose.emit()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=O({type:o,selectors:[["app-form-periodo"]],inputs:{parcelaId:"parcelaId"},outputs:{onClose:"onClose",onSave:"onSave"},decls:13,vars:2,consts:[[1,"modal-overlay"],[1,"modal-container"],[1,"modal-header"],[1,"header-content"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"header-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],[1,"header-title"],["type","button",1,"btn-close",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["class","loading-container",4,"ngIf"],["class","modal-body",3,"ngSubmit",4,"ngIf"],[1,"loading-container"],["fill","none","viewBox","0 0 24 24",1,"loading-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"loading-text"],[1,"modal-body",3,"ngSubmit"],[1,"form-section"],[1,"section-header"],[1,"section-badge"],[1,"section-title"],[1,"form-grid"],[1,"form-group"],[1,"form-label"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"label-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"],[1,"required"],[1,"select-wrapper"],["name","parcelaId","required","",1,"form-select",3,"ngModelChange","ngModel","disabled"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"select-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["name","cultivoId","required","",1,"form-select",3,"ngModelChange","ngModel"],[1,"form-grid","form-grid-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["type","date","name","fechaInicio","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","date","name","fechaCosechaEsperada",1,"form-input",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"],[1,"input-with-unit"],["type","number","name","hectareasSembradas","required","","min","0.01","step","0.01","placeholder","0.00",1,"form-input",3,"ngModelChange","ngModel"],[1,"input-unit"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"],["type","number","name","rendimientoEsperado","min","0","step","0.01","placeholder","0.00",1,"form-input",3,"ngModelChange","ngModel"],[1,"info-box"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"info-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"info-text"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["name","observaciones","rows","4","placeholder","A\xF1ade notas sobre condiciones especiales, planificaci\xF3n, objetivos o cualquier informaci\xF3n relevante de este per\xEDodo de siembra...",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"form-hint"],[1,"modal-footer"],["type","button",1,"btn-secondary",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["type","submit",1,"btn-primary",3,"disabled"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-4 h-4 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],[3,"value"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","animate-spin"]],template:function(t,d){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m(),e(4,"svg",4),s(5,"path",5),n(),g(),e(6,"h2",6),a(7,"Iniciar Per\xEDodo de Siembra"),n()(),e(8,"button",7),v("click",function(){return d.cerrar()}),m(),e(9,"svg",8),s(10,"path",9),n()()(),x(11,ge,6,0,"div",10)(12,xe,113,16,"form",11),n()()),t&2&&(r(11),c("ngIf",d.loadingData),r(),c("ngIf",!d.loadingData))},dependencies:[I,E,k,J,W,q,Y,H,N,R,L,G,X,U,B,j],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;padding:1rem;z-index:50;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.modal-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;max-width:680px;width:100%;max-height:90vh;display:flex;flex-direction:column;box-shadow:0 20px 50px #00000026;animation:_ngcontent-%COMP%_slideUp .3s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;border-bottom:1px solid #e5e7eb;padding:1.25rem 1.5rem;display:flex;align-items:center;justify-content:space-between;border-radius:12px 12px 0 0;z-index:10}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex:1}.header-icon[_ngcontent-%COMP%]{width:24px;height:24px;color:#1a7f5a;flex-shrink:0}.header-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin:0}@media (min-width: 640px){.header-title[_ngcontent-%COMP%]{font-size:1.25rem}}.btn-close[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;border:none;background:transparent;color:#6b7280;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;flex-shrink:0}.btn-close[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}.loading-container[_ngcontent-%COMP%]{padding:4rem 2rem;text-align:center}.loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 1rem;color:#1a7f5a;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:.95rem;color:#6b7280;font-weight:500;margin:0}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}@media (min-width: 640px){.modal-body[_ngcontent-%COMP%]{padding:2rem}}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem}.form-section[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.25rem;padding-bottom:.75rem;border-bottom:2px solid #f3f4f6}.section-badge[_ngcontent-%COMP%]{width:28px;height:28px;background:#1a7f5a;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.875rem;font-weight:700;flex-shrink:0}.section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#111827;margin:0}@media (min-width: 640px){.section-title[_ngcontent-%COMP%]{font-size:1.0625rem}}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.25rem}@media (min-width: 640px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.form-grid-3[_ngcontent-%COMP%]{grid-template-columns:1fr}@media (min-width: 768px){.form-grid-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group-full[_ngcontent-%COMP%]{grid-column:1 / -1}.form-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#374151;display:flex;align-items:center;gap:.5rem}.label-icon[_ngcontent-%COMP%]{width:16px;height:16px;color:#6b7280;flex-shrink:0}.required[_ngcontent-%COMP%]{color:#ef4444;font-weight:700}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #d1d5db;border-radius:8px;font-size:.9rem;transition:all .2s ease;background:#fff;font-family:inherit;color:#111827}.form-input[_ngcontent-%COMP%]::placeholder, .form-textarea[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-input[_ngcontent-%COMP%]:hover, .form-select[_ngcontent-%COMP%]:hover, .form-textarea[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a7f5a;box-shadow:0 0 0 3px #1a7f5a14}.form-input-disabled[_ngcontent-%COMP%]{background:#f9fafb;color:#6b7280;cursor:not-allowed}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px;line-height:1.5}.input-with-unit[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-with-unit[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding-right:3rem}.input-unit[_ngcontent-%COMP%]{position:absolute;right:1rem;font-size:.875rem;font-weight:600;color:#6b7280;pointer-events:none}.select-wrapper[_ngcontent-%COMP%]{position:relative}.form-select[_ngcontent-%COMP%]{appearance:none;padding-right:2.75rem;cursor:pointer;font-weight:500}.select-icon[_ngcontent-%COMP%]{position:absolute;right:.875rem;top:50%;transform:translateY(-50%);width:18px;height:18px;color:#6b7280;pointer-events:none}.info-box[_ngcontent-%COMP%]{background:#eff6ff;border:1px solid #dbeafe;border-radius:8px;padding:.875rem;display:flex;gap:.75rem;align-items:flex-start}.info-icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#3b82f6;flex-shrink:0;margin-top:2px}.info-text[_ngcontent-%COMP%]{font-size:.8rem;color:#1e40af;margin:0;line-height:1.5}.form-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin:0;line-height:1.4}.modal-footer[_ngcontent-%COMP%]{position:sticky;bottom:0;background:#fff;border-top:1px solid #e5e7eb;padding:1.25rem 1.5rem;display:flex;gap:.75rem;border-radius:0 0 12px 12px}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]{padding:1.5rem 2rem}}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{flex:1;padding:.75rem 1.25rem;border-radius:8px;font-weight:600;font-size:.9rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem;transition:all .2s ease;border:1px solid}.btn-primary[_ngcontent-%COMP%]{background:#1a7f5a;color:#fff;border-color:#1a7f5a}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#166649;border-color:#166649}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#374151;border-color:#d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#9ca3af}.w-4[_ngcontent-%COMP%]{width:1rem;height:1rem}.w-5[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (max-width: 639px){.modal-header[_ngcontent-%COMP%]{padding:1rem 1.25rem}.modal-body[_ngcontent-%COMP%]{padding:1.25rem}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.25rem}.form-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.section-badge[_ngcontent-%COMP%]{width:24px;height:24px;font-size:.75rem}.section-title[_ngcontent-%COMP%]{font-size:.9375rem}.form-grid[_ngcontent-%COMP%]{gap:1rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.6875rem 1rem;font-size:.875rem}}@media (max-width: 767px){.form-grid-3[_ngcontent-%COMP%]{gap:1rem}}"]})};function ve(o,i){o&1&&(e(0,"div",12),m(),e(1,"svg",13),s(2,"circle",14)(3,"path",15),n(),g(),e(4,"p",16),a(5,"Cargando datos..."),n()())}function be(o,i){if(o&1&&(e(0,"option",49),a(1),n()),o&2){let t=i.$implicit;c("value",t.id),r(),V(" ",t.parcela==null?null:t.parcela.nombre," - ",t.cultivo==null?null:t.cultivo.nombre," ")}}function Ce(o,i){if(o&1&&(e(0,"option",49),a(1),n()),o&2){let t=i.$implicit;c("value",t),r(),h(t)}}function Me(o,i){if(o&1&&(e(0,"option",49),a(1),n()),o&2){let t=i.$implicit;c("value",t.id),r(),D(" ",t.nombre," (Stock: ",t.stockActual," ",t.unidadMedida,") ")}}function Pe(o,i){if(o&1){let t=y();e(0,"tr")(1,"td")(2,"div",65)(3,"span",66),a(4),n(),e(5,"span",67),a(6),n()()(),e(7,"td")(8,"input",68),P("ngModelChange",function(l){let f=u(t).$implicit;return M(f.dosisPorHectarea,l)||(f.dosisPorHectarea=l),_(l)}),v("ngModelChange",function(){let l=u(t).$implicit,f=p(3);return _(f.calcularCantidad(l))}),n()(),e(9,"td")(10,"input",68),P("ngModelChange",function(l){let f=u(t).$implicit;return M(f.cantidad,l)||(f.cantidad=l),_(l)}),n()(),e(11,"td")(12,"span",69),a(13),n()(),e(14,"td",63)(15,"button",70),v("click",function(){let l=u(t).index,f=p(3);return _(f.eliminarInsumo(l))}),m(),e(16,"svg",46),s(17,"path",71),n()()()()}if(o&2){let t=i.$implicit,d=i.index;r(4),h(t.nombre),r(2),h(t.unidadMedida),r(2),C("ngModel",t.dosisPorHectarea),c("name","dosis_"+d),r(2),w("input-error",t.cantidad>(t.stockDisponible||0)),C("ngModel",t.cantidad),c("name","cantidad_"+d),r(2),w("stock-error",t.cantidad>(t.stockDisponible||0)),r(),b(" ",t.stockDisponible," ")}}function Se(o,i){if(o&1&&(e(0,"div",61)(1,"table",62)(2,"thead")(3,"tr")(4,"th"),a(5,"Insumo"),n(),e(6,"th"),a(7,"Dosis/ha"),n(),e(8,"th"),a(9,"Cantidad Total"),n(),e(10,"th"),a(11,"Stock Disponible"),n(),e(12,"th",63),a(13,"Acci\xF3n"),n()()(),e(14,"tbody"),x(15,Pe,18,11,"tr",64),n()()()),o&2){let t=p(2);r(15),c("ngForOf",t.insumosSeleccionados)}}function we(o,i){if(o&1){let t=y();e(0,"div",74)(1,"div",75)(2,"div")(3,"span",66),a(4),n(),e(5,"span",67),a(6),n()(),e(7,"button",76),v("click",function(){let l=u(t).index,f=p(3);return _(f.eliminarInsumo(l))}),m(),e(8,"svg",46),s(9,"path",71),n()()(),g(),e(10,"div",77)(11,"div",78)(12,"label",79),a(13,"Dosis por Hect\xE1rea"),n(),e(14,"input",80),P("ngModelChange",function(l){let f=u(t).$implicit;return M(f.dosisPorHectarea,l)||(f.dosisPorHectarea=l),_(l)}),v("ngModelChange",function(){let l=u(t).$implicit,f=p(3);return _(f.calcularCantidad(l))}),n()(),e(15,"div",78)(16,"label",79),a(17,"Cantidad Total"),n(),e(18,"input",80),P("ngModelChange",function(l){let f=u(t).$implicit;return M(f.cantidad,l)||(f.cantidad=l),_(l)}),n()(),e(19,"div",81),m(),e(20,"svg",46),s(21,"path",5),n(),g(),e(22,"span"),a(23),n()()()()}if(o&2){let t=i.$implicit,d=i.index;r(4),h(t.nombre),r(2),h(t.unidadMedida),r(8),C("ngModel",t.dosisPorHectarea),c("name","dosis_mobile_"+d),r(4),w("input-error",t.cantidad>(t.stockDisponible||0)),C("ngModel",t.cantidad),c("name","cantidad_mobile_"+d),r(),w("stock-warning",t.cantidad>(t.stockDisponible||0)),r(4),b("Stock disponible: ",t.stockDisponible)}}function ye(o,i){if(o&1&&(e(0,"div",72),x(1,we,24,11,"div",73),n()),o&2){let t=p(2);r(),c("ngForOf",t.insumosSeleccionados)}}function Oe(o,i){o&1&&(e(0,"div",82),m(),e(1,"svg",83),s(2,"path",5),n(),g(),e(3,"p",84),a(4,"No hay insumos agregados"),n(),e(5,"p",85),a(6,'Selecciona un insumo y haz clic en "Agregar"'),n()())}function Ee(o,i){o&1&&(m(),e(0,"svg",46),s(1,"path",86),n())}function ke(o,i){o&1&&(m(),e(0,"svg",87),s(1,"circle",14)(2,"path",15),n())}function Ie(o,i){if(o&1){let t=y();e(0,"form",17),v("ngSubmit",function(){u(t);let l=p();return _(l.guardar())}),e(1,"div",18)(2,"div",19)(3,"div",20),a(4,"1"),n(),e(5,"h3",21),a(6,"Informaci\xF3n General"),n()(),e(7,"div",22)(8,"div",23)(9,"label",24),m(),e(10,"svg",25),s(11,"path",26),n(),a(12," Per\xEDodo de Siembra "),g(),e(13,"span",27),a(14,"*"),n()(),e(15,"div",28)(16,"select",29),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.periodoSiembraId,l)||(f.formData.periodoSiembraId=l),_(l)}),v("ngModelChange",function(){u(t);let l=p();return _(l.onPeriodoChange())}),e(17,"option",30),a(18,"Seleccionar per\xEDodo..."),n(),x(19,be,2,3,"option",31),n(),m(),e(20,"svg",32),s(21,"path",33),n()()(),g(),e(22,"div",23)(23,"label",24),m(),e(24,"svg",25),s(25,"path",34),n(),a(26," Tipo de Aplicaci\xF3n "),g(),e(27,"span",27),a(28,"*"),n()(),e(29,"div",28)(30,"select",35),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.tipoAplicacion,l)||(f.formData.tipoAplicacion=l),_(l)}),x(31,Ce,2,2,"option",31),n(),m(),e(32,"svg",32),s(33,"path",33),n()()(),g(),e(34,"div",23)(35,"label",24),m(),e(36,"svg",25),s(37,"path",36),n(),a(38," Fecha de Aplicaci\xF3n "),g(),e(39,"span",27),a(40,"*"),n()(),e(41,"input",37),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.fecha,l)||(f.formData.fecha=l),_(l)}),n()(),e(42,"div",23)(43,"label",24),m(),e(44,"svg",25),s(45,"path",38),n(),a(46," Hect\xE1reas Aplicadas "),g(),e(47,"span",27),a(48,"*"),n()(),e(49,"div",39)(50,"input",40),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.hectareasAplicadas,l)||(f.formData.hectareasAplicadas=l),_(l)}),n(),e(51,"span",41),a(52,"ha"),n()()(),e(53,"div",42)(54,"label",24),m(),e(55,"svg",25),s(56,"path",43),n(),a(57," Responsable de la Aplicaci\xF3n "),n(),g(),e(58,"input",44),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.responsable,l)||(f.formData.responsable=l),_(l)}),n()()()(),e(59,"div",18)(60,"div",19)(61,"div",20),a(62,"2"),n(),e(63,"h3",21),a(64,"Insumos Aplicados"),n(),e(65,"button",45),v("click",function(){u(t);let l=p();return _(l.agregarInsumo())}),m(),e(66,"svg",46),s(67,"path",47),n(),g(),e(68,"span"),a(69,"Agregar"),n()()(),e(70,"div",23)(71,"label",24),m(),e(72,"svg",25),s(73,"path",5),n(),a(74," Seleccionar Insumo "),n(),g(),e(75,"div",28)(76,"select",48),P("ngModelChange",function(l){u(t);let f=p();return M(f.insumoSeleccionado,l)||(f.insumoSeleccionado=l),_(l)}),e(77,"option",49),a(78,"Seleccionar insumo del inventario..."),n(),x(79,Me,2,4,"option",31),n(),m(),e(80,"svg",32),s(81,"path",33),n()()(),x(82,Se,16,1,"div",50)(83,ye,2,1,"div",51)(84,Oe,7,0,"div",52),n(),g(),e(85,"div",18)(86,"div",19)(87,"div",20),a(88,"3"),n(),e(89,"h3",21),a(90,"Notas y Observaciones"),n()(),e(91,"div",23)(92,"label",24),m(),e(93,"svg",25),s(94,"path",53),n(),a(95," Observaciones de la Aplicaci\xF3n "),n(),g(),e(96,"textarea",54),P("ngModelChange",function(l){u(t);let f=p();return M(f.formData.observaciones,l)||(f.formData.observaciones=l),_(l)}),n(),e(97,"p",55),a(98,"Opcional - Informaci\xF3n adicional sobre la aplicaci\xF3n"),n()()(),e(99,"div",56)(100,"button",57),v("click",function(){u(t);let l=p();return _(l.cerrar())}),m(),e(101,"svg",46),s(102,"path",9),n(),g(),e(103,"span"),a(104,"Cancelar"),n()(),e(105,"button",58),x(106,Ee,2,0,"svg",59)(107,ke,3,0,"svg",60),e(108,"span"),a(109),n()()()()}if(o&2){let t=p();r(16),w("form-input-disabled",!!t.periodoId),C("ngModel",t.formData.periodoSiembraId),c("disabled",!!t.periodoId),r(3),c("ngForOf",t.periodos),r(11),C("ngModel",t.formData.tipoAplicacion),r(),c("ngForOf",t.TIPOS_APLICACION),r(10),C("ngModel",t.formData.fecha),r(9),C("ngModel",t.formData.hectareasAplicadas),r(8),C("ngModel",t.formData.responsable),r(18),C("ngModel",t.insumoSeleccionado),r(),c("value",0),r(2),c("ngForOf",t.insumos),r(3),c("ngIf",t.insumosSeleccionados.length>0),r(),c("ngIf",t.insumosSeleccionados.length>0),r(),c("ngIf",t.insumosSeleccionados.length===0),r(12),C("ngModel",t.formData.observaciones),r(9),c("disabled",t.loading||t.insumosSeleccionados.length===0),r(),c("ngIf",!t.loading),r(),c("ngIf",t.loading),r(2),h(t.loading?"Registrando...":"Registrar Aplicaci\xF3n")}}var $=class o{parcelasService=S(T);http=S(A);periodoId;parcelaId;onClose=new z;onSave=new z;periodos=[];insumos=[];insumosSeleccionados=[];TIPOS_APLICACION=de;loading=!1;loadingData=!1;formData={periodoSiembraId:0,parcelaId:0,fecha:new Date().toISOString().split("T")[0],hectareasAplicadas:0,tipoAplicacion:"Fertilizaci\xF3n",insumos:[],responsable:"",observaciones:""};insumoSeleccionado=0;ngOnInit(){this.cargarDatos(),this.periodoId&&(this.formData.periodoSiembraId=this.periodoId),this.parcelaId&&(this.formData.parcelaId=this.parcelaId)}cargarDatos(){this.loadingData=!0,this.parcelasService.getPeriodosSiembra(void 0,"En Curso").subscribe({next:i=>{this.periodos=i,this.periodoId&&this.onPeriodoChange()},error:i=>console.error("Error al cargar per\xEDodos:",i)}),this.http.get("http://localhost:3000/api/inventario").subscribe({next:i=>{this.insumos=i.filter(t=>t.stockActual>0),this.loadingData=!1},error:i=>{console.error("Error al cargar insumos:",i),this.loadingData=!1}})}onPeriodoChange(){let i=this.periodos.find(t=>t.id===this.formData.periodoSiembraId);i&&(this.formData.parcelaId=i.parcelaId,this.formData.hectareasAplicadas===0&&(this.formData.hectareasAplicadas=i.hectareasSembradas))}agregarInsumo(){if(!this.insumoSeleccionado){alert("Selecciona un insumo");return}if(this.insumosSeleccionados.find(t=>t.insumoId===this.insumoSeleccionado)){alert("Este insumo ya fue agregado");return}let i=this.insumos.find(t=>t.id===this.insumoSeleccionado);i&&this.insumosSeleccionados.push({insumoId:i.id,cantidad:0,dosisPorHectarea:0,nombre:i.nombre,unidadMedida:i.unidadMedida,stockDisponible:i.stockActual}),this.insumoSeleccionado=0}calcularCantidad(i){i.dosisPorHectarea>0&&this.formData.hectareasAplicadas>0&&(i.cantidad=i.dosisPorHectarea*this.formData.hectareasAplicadas)}eliminarInsumo(i){this.insumosSeleccionados.splice(i,1)}guardar(){this.validarFormulario()&&(this.formData.insumos=this.insumosSeleccionados.map(i=>({insumoId:i.insumoId,cantidad:i.cantidad,dosisPorHectarea:i.dosisPorHectarea})),this.loading=!0,this.parcelasService.registrarAplicacion(this.formData).subscribe({next:()=>{alert("Aplicaci\xF3n registrada correctamente"),this.onSave.emit(),this.cerrar()},error:i=>{console.error("Error al registrar aplicaci\xF3n:",i),alert(i.error?.message||"Error al registrar la aplicaci\xF3n"),this.loading=!1}}))}validarFormulario(){if(!this.formData.periodoSiembraId)return alert("Selecciona un per\xEDodo de siembra"),!1;if(this.formData.hectareasAplicadas<=0)return alert("Las hect\xE1reas aplicadas deben ser mayor a 0"),!1;if(this.insumosSeleccionados.length===0)return alert("Agrega al menos un insumo"),!1;for(let i of this.insumosSeleccionados){if(i.cantidad<=0)return alert(`La cantidad de ${i.nombre} debe ser mayor a 0`),!1;if(i.cantidad>(i.stockDisponible||0))return alert(`No hay suficiente stock de ${i.nombre} (disponible: ${i.stockDisponible})`),!1}return!0}cerrar(){this.onClose.emit()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=O({type:o,selectors:[["app-form-aplicacion"]],inputs:{periodoId:"periodoId",parcelaId:"parcelaId"},outputs:{onClose:"onClose",onSave:"onSave"},decls:13,vars:2,consts:[[1,"modal-overlay"],[1,"modal-container","modal-wide"],[1,"modal-header"],[1,"header-content"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"header-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"header-title"],["type","button",1,"btn-close",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["class","loading-container",4,"ngIf"],["class","modal-body",3,"ngSubmit",4,"ngIf"],[1,"loading-container"],["fill","none","viewBox","0 0 24 24",1,"loading-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"loading-text"],[1,"modal-body",3,"ngSubmit"],[1,"form-section"],[1,"section-header"],[1,"section-badge"],[1,"section-title"],[1,"form-grid","form-grid-2"],[1,"form-group"],[1,"form-label"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"label-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],[1,"required"],[1,"select-wrapper"],["name","periodoSiembraId","required","",1,"form-select",3,"ngModelChange","ngModel","disabled"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"select-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],["name","tipoAplicacion","required","",1,"form-select",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["type","date","name","fecha","required","",1,"form-input",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"],[1,"input-with-unit"],["type","number","name","hectareasAplicadas","required","","min","0.01","step","0.01","placeholder","0.00",1,"form-input",3,"ngModelChange","ngModel"],[1,"input-unit"],[1,"form-group","form-group-full"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["type","text","name","responsable","placeholder","Nombre del responsable de la aplicaci\xF3n",1,"form-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-add-insumo",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["name","insumoSelector",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],["class","table-container",4,"ngIf"],["class","insumos-cards",4,"ngIf"],["class","empty-state-insumos",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["name","observaciones","rows","4","placeholder","A\xF1ade notas sobre condiciones clim\xE1ticas, m\xE9todos de aplicaci\xF3n, resultados observados o cualquier informaci\xF3n relevante...",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"form-hint"],[1,"modal-footer"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],["class","w-4 h-4","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-4 h-4 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"table-container"],[1,"insumos-table"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"insumo-info"],[1,"insumo-name"],[1,"insumo-unit"],["type","number","min","0.01","step","0.01",1,"table-input",3,"ngModelChange","ngModel","name"],[1,"stock-value"],["type","button","title","Eliminar insumo",1,"btn-delete",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"insumos-cards"],["class","insumo-card",4,"ngFor","ngForOf"],[1,"insumo-card"],[1,"card-header-insumo"],["type","button","title","Eliminar",1,"btn-delete",3,"click"],[1,"card-body-insumo"],[1,"card-field"],[1,"card-label"],["type","number","min","0.01","step","0.01",1,"form-input",3,"ngModelChange","ngModel","name"],[1,"stock-info"],[1,"empty-state-insumos"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"empty-icon-insumos"],[1,"empty-title-insumos"],[1,"empty-text-insumos"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","animate-spin"]],template:function(t,d){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m(),e(4,"svg",4),s(5,"path",5),n(),g(),e(6,"h2",6),a(7,"Registrar Aplicaci\xF3n de Insumos"),n()(),e(8,"button",7),v("click",function(){return d.cerrar()}),m(),e(9,"svg",8),s(10,"path",9),n()()(),x(11,ve,6,0,"div",10)(12,Ie,110,21,"form",11),n()()),t&2&&(r(11),c("ngIf",d.loadingData),r(),c("ngIf",!d.loadingData))},dependencies:[I,E,k,J,W,q,Y,H,N,R,L,G,X,U,B,j],styles:[".modal-wide[_ngcontent-%COMP%]{max-width:900px}.form-grid-2[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.25rem}@media (min-width: 640px){.form-grid-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.25rem;padding-bottom:.75rem;border-bottom:2px solid #f3f4f6}.btn-add-insumo[_ngcontent-%COMP%]{margin-left:auto;padding:.5rem 1rem;background:#3b82f6;color:#fff;border:none;border-radius:6px;font-size:.85rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:all .2s ease;flex-shrink:0}.btn-add-insumo[_ngcontent-%COMP%]:hover{background:#2563eb}.table-container[_ngcontent-%COMP%]{display:none;overflow-x:auto;border:1px solid #e5e7eb;border-radius:8px}@media (min-width: 768px){.table-container[_ngcontent-%COMP%]{display:block}}.insumos-table[_ngcontent-%COMP%]{width:100%;min-width:700px;border-collapse:collapse}.insumos-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f9fafb}.insumos-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.875rem 1rem;text-align:left;font-size:.8rem;font-weight:700;color:#374151;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid #e5e7eb}.insumos-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6;transition:background .2s ease}.insumos-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#fafafa}.insumos-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;font-size:.9rem}.insumo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.insumo-name[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:.9rem}.insumo-unit[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.table-input[_ngcontent-%COMP%]{width:100%;max-width:100px;padding:.5rem;border:1px solid #d1d5db;border-radius:6px;font-size:.85rem;transition:all .2s ease;font-family:inherit}.table-input[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.table-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a7f5a;box-shadow:0 0 0 3px #1a7f5a14}.input-error[_ngcontent-%COMP%]{border-color:#ef4444!important}.input-error[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef444414!important}.stock-value[_ngcontent-%COMP%]{font-weight:600;color:#111827}.stock-error[_ngcontent-%COMP%]{color:#ef4444}.btn-delete[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;border:none;background:#fff;color:#ef4444;border:1px solid #fecaca;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;transition:all .2s ease}.btn-delete[_ngcontent-%COMP%]:hover{background:#fef2f2;border-color:#fca5a5}.text-center[_ngcontent-%COMP%]{text-align:center}.insumos-cards[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}@media (min-width: 768px){.insumos-cards[_ngcontent-%COMP%]{display:none}}.insumo-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden}.card-header-insumo[_ngcontent-%COMP%]{background:#f9fafb;padding:1rem;display:flex;justify-content:space-between;align-items:flex-start;gap:.75rem;border-bottom:1px solid #e5e7eb}.card-header-insumo[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;flex:1;min-width:0}.card-header-insumo[_ngcontent-%COMP%]   .insumo-name[_ngcontent-%COMP%]{font-size:.95rem}.card-body-insumo[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;gap:1rem}.card-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.card-label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:#6b7280}.stock-info[_ngcontent-%COMP%]{padding:.75rem;background:#eff6ff;border:1px solid #dbeafe;border-radius:8px;display:flex;align-items:center;gap:.5rem;font-size:.85rem;color:#1e40af;font-weight:500}.stock-warning[_ngcontent-%COMP%]{background:#fef2f2;border-color:#fecaca;color:#991b1b}.empty-state-insumos[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;background:#f9fafb;border:2px dashed #d1d5db;border-radius:12px}.empty-icon-insumos[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 1rem;color:#d1d5db}.empty-title-insumos[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:#374151;margin:0 0 .5rem}.empty-text-insumos[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin:0}@media (max-width: 639px){.modal-wide[_ngcontent-%COMP%]{max-width:100%}.btn-add-insumo[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.8rem}.btn-add-insumo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}@media (min-width: 640px) and (max-width: 899px){.modal-wide[_ngcontent-%COMP%]{max-width:95%}}.w-4[_ngcontent-%COMP%]{width:1rem;height:1rem}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};var Te=(o,i,t)=>({"status-active":o,"status-completed":i,"status-cancelled":t});function Ve(o,i){o&1&&(e(0,"div",3),m(),e(1,"svg",4),s(2,"circle",5)(3,"path",6),n(),g(),e(4,"p",7),a(5,"Cargando trazabilidad..."),n()())}function ze(o,i){o&1&&(e(0,"div",10)(1,"div",11),m(),e(2,"svg",12),s(3,"path",13),n()(),g(),e(4,"h3",14),a(5,"Sin eventos registrados"),n(),e(6,"p",15),a(7,"No hay eventos de trazabilidad para esta parcela"),n()())}function De(o,i){if(o&1&&(e(0,"span",60),m(),e(1,"svg",61),s(2,"path",62),n(),a(3),n()),o&2){let t=p().$implicit,d=p(3);r(3),b(" ",d.formatearFecha(t.periodo.fechaFin)," ")}}function Fe(o,i){o&1&&s(0,"div",79)}function Ae(o,i){if(o&1&&(e(0,"span",80),a(1),n()),o&2){let t=p().$implicit,d=p(4);r(),b(" ",d.formatearHectareas(t.hectareas)," ")}}function He(o,i){if(o&1&&(e(0,"div",87)(1,"div",88)(2,"span",89),a(3),n(),e(4,"span",90),a(5),n()(),e(6,"span",91),a(7),n()()),o&2){let t=i.$implicit;r(3),h(t.nombre),r(2),V("(",t.dosis," ",t.unidad,"/ha)"),r(2),V("",t.cantidad," ",t.unidad)}}function Le(o,i){if(o&1&&(e(0,"div",81)(1,"div",82),m(),e(2,"svg",83),s(3,"path",70),n(),g(),e(4,"span",84),a(5,"Insumos Aplicados"),n()(),e(6,"div",85),x(7,He,8,5,"div",86),n()()),o&2){let t=p().$implicit;r(7),c("ngForOf",t.insumos)}}function Ge(o,i){if(o&1&&(e(0,"span",92),m(),e(1,"svg",83),s(2,"path",93),n(),a(3),n()),o&2){let t=p().$implicit;r(3),b(" ",t.responsable," ")}}function je(o,i){if(o&1&&(e(0,"span",94),a(1),n()),o&2){let t=p().$implicit,d=p(4);r(),h(d.formatearCosto(t.costo))}}function Be(o,i){if(o&1&&(e(0,"div",63),x(1,Fe,1,0,"div",64),s(2,"div",65),e(3,"div",66)(4,"div",67)(5,"div",68),m(),e(6,"svg",69),s(7,"path",70),n()(),g(),e(8,"div",71)(9,"h4",72),a(10),n(),e(11,"p",73),a(12),n()(),x(13,Ae,2,1,"span",74),n(),x(14,Le,8,1,"div",75),e(15,"div",76),x(16,Ge,4,1,"span",77)(17,je,2,1,"span",78),n()()()),o&2){let t=i.$implicit,d=i.last,l=p(4);r(),c("ngIf",!d),r(9),h(t.tipoAplicacion||t.nombre),r(2),h(l.formatearFecha(t.fecha)),r(),c("ngIf",t.hectareas),r(),c("ngIf",t.insumos&&t.insumos.length>0),r(2),c("ngIf",t.responsable),r(),c("ngIf",t.costo)}}function We(o,i){o&1&&(e(0,"div",95),m(),e(1,"svg",96),s(2,"path",97),n(),g(),e(3,"p",98),a(4,"No hay eventos en este per\xEDodo"),n()())}function Ne(o,i){if(o&1&&(e(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",40),m(),e(4,"svg",41),s(5,"path",42),n()(),g(),e(6,"div",43)(7,"h3",44),a(8),n(),e(9,"p",45),a(10),x(11,De,4,1,"span",46),n()()(),e(12,"span",47),a(13),n()(),e(14,"div",48)(15,"div",49),m(),e(16,"svg",50),s(17,"path",51),n(),g(),e(18,"div",52)(19,"span",53),a(20,"Hect\xE1reas"),n(),e(21,"span",54),a(22),n()()(),e(23,"div",49),m(),e(24,"svg",50),s(25,"path",35),n(),g(),e(26,"div",52)(27,"span",53),a(28,"Rendimiento"),n(),e(29,"span",54),a(30),n()()(),e(31,"div",49),m(),e(32,"svg",50),s(33,"path",13),n(),g(),e(34,"div",52)(35,"span",53),a(36,"Eventos"),n(),e(37,"span",55),a(38),n()()(),e(39,"div",49),m(),e(40,"svg",50),s(41,"path",32),n(),g(),e(42,"div",52)(43,"span",53),a(44,"Costo Total"),n(),e(45,"span",56),a(46),n()()()(),e(47,"div",57),x(48,Be,18,7,"div",58)(49,We,5,0,"div",59),n()()),o&2){let t=i.$implicit,d=p(3);r(8),h(t.periodo.cultivo),r(2),b(" ",d.formatearFecha(t.periodo.fechaInicio)," "),r(),c("ngIf",t.periodo.fechaFin),r(),c("ngClass",ae(11,Te,t.periodo.estado==="En Curso",t.periodo.estado==="Finalizado",t.periodo.estado==="Cancelado")),r(),b(" ",t.periodo.estado," "),r(9),h(d.formatearHectareas(t.periodo.hectareas)),r(8),b("",t.periodo.rendimiento||0," ton"),r(8),h(t.eventos.length),r(8),h(d.formatearCosto(t.periodo.costoTotal)),r(2),c("ngForOf",t.eventos),r(),c("ngIf",t.eventos.length===0)}}function Re(o,i){if(o&1&&(e(0,"div",16)(1,"div",17),x(2,Ne,50,15,"div",18),n(),e(3,"div",19)(4,"div",20),m(),e(5,"svg",21),s(6,"path",22),n(),g(),e(7,"h3",23),a(8,"Resumen de Trazabilidad"),n()(),e(9,"div",24)(10,"div",25),m(),e(11,"svg",26),s(12,"path",27),n(),g(),e(13,"span",28),a(14,"Per\xEDodos"),n(),e(15,"span",29),a(16),n()(),e(17,"div",30),m(),e(18,"svg",26),s(19,"path",13),n(),g(),e(20,"span",28),a(21,"Eventos"),n(),e(22,"span",29),a(23),n()(),e(24,"div",31),m(),e(25,"svg",26),s(26,"path",32),n(),g(),e(27,"span",28),a(28,"Costo Total"),n(),e(29,"span",33),a(30),n()(),e(31,"div",34),m(),e(32,"svg",26),s(33,"path",35),n(),g(),e(34,"span",28),a(35,"Producci\xF3n"),n(),e(36,"span",29),a(37),e(38,"span",36),a(39,"ton"),n()()()()()()),o&2){let t=p(2);r(2),c("ngForOf",t.trazabilidad.trazabilidad),r(14),h(t.totalPeriodos),r(7),h(t.totalEventos),r(7),h(t.formatearCosto(t.totalCosto)),r(7),b("",t.totalProduccion," ")}}function qe(o,i){if(o&1&&(e(0,"div"),x(1,ze,8,0,"div",8)(2,Re,40,5,"div",9),n()),o&2){let t=p();r(),c("ngIf",t.trazabilidad.trazabilidad.length===0),r(),c("ngIf",t.trazabilidad.trazabilidad.length>0)}}var ee=class o{parcelasService=S(T);parcelaId;trazabilidad;loading=!1;totalPeriodos=0;totalEventos=0;totalCosto=0;totalProduccion=0;ngOnInit(){this.parcelaId&&this.cargarTrazabilidad()}cargarTrazabilidad(){this.loading=!0,this.parcelasService.getTrazabilidad(this.parcelaId).subscribe({next:i=>{this.trazabilidad=i,this.calcularResumen(),this.loading=!1},error:i=>{console.error("Error al cargar trazabilidad:",i),this.loading=!1}})}calcularResumen(){this.trazabilidad&&(this.totalPeriodos=this.trazabilidad.trazabilidad.length,this.totalEventos=this.trazabilidad.trazabilidad.reduce((i,t)=>i+t.eventos.length,0),this.totalCosto=this.trazabilidad.trazabilidad.reduce((i,t)=>i+(t.periodo.costoTotal||0),0),this.totalProduccion=this.trazabilidad.trazabilidad.reduce((i,t)=>i+(t.periodo.rendimiento||0),0))}formatearFecha(i){return new Date(i).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}formatearCosto(i){return Q(i)}formatearHectareas(i){return K(i)}getEventIcon(i,t){if(i==="Aplicaci\xF3n")switch(t){case"Fertilizaci\xF3n":return"\u{1F331}";case"Fumigaci\xF3n":return"\u{1F4A8}";case"Control de Plagas":return"\u{1F99F}";case"Control de Malezas":return"\u{1F33F}";case"Riego":return"\u{1F4A7}";default:return"\u{1F4CB}"}return"\u{1F4C5}"}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=O({type:o,selectors:[["app-trazabilidad"]],inputs:{parcelaId:"parcelaId"},decls:3,vars:2,consts:[[1,"page-container"],["class","loading-card",4,"ngIf"],[4,"ngIf"],[1,"loading-card"],["fill","none","viewBox","0 0 24 24",1,"loading-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"loading-text"],["class","empty-state",4,"ngIf"],["class","content-layout",4,"ngIf"],[1,"empty-state"],[1,"empty-icon"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"],[1,"empty-title"],[1,"empty-description"],[1,"content-layout"],[1,"periods-container"],["class","period-section",4,"ngFor","ngForOf"],[1,"summary-card"],[1,"summary-header"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"summary-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"summary-title"],[1,"summary-stats"],[1,"summary-stat","summary-stat-blue"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"summary-stat-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"summary-stat-label"],[1,"summary-stat-value"],[1,"summary-stat","summary-stat-purple"],[1,"summary-stat","summary-stat-green"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"summary-stat-value","summary-stat-value-sm"],[1,"summary-stat","summary-stat-yellow"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"],[1,"summary-stat-unit"],[1,"period-section"],[1,"period-header"],[1,"period-header-content"],[1,"period-icon-wrapper"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"period-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],[1,"period-info"],[1,"period-title"],[1,"period-dates"],["class","date-separator",4,"ngIf"],[1,"period-status",3,"ngClass"],[1,"period-stats"],[1,"stat-item"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"stat-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"],[1,"stat-content"],[1,"stat-label"],[1,"stat-value"],[1,"stat-value","stat-value-accent"],[1,"stat-value","stat-value-success"],[1,"timeline-container"],["class","timeline-item",4,"ngFor","ngForOf"],["class","no-events",4,"ngIf"],[1,"date-separator"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"date-arrow"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14 5l7 7m0 0l-7 7m7-7H3"],[1,"timeline-item"],["class","timeline-line",4,"ngIf"],[1,"timeline-dot"],[1,"event-card"],[1,"event-header"],[1,"event-icon-wrapper"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"event-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"event-info"],[1,"event-title"],[1,"event-date"],["class","event-badge",4,"ngIf"],["class","event-insumos",4,"ngIf"],[1,"event-footer"],["class","event-responsible",4,"ngIf"],["class","event-cost",4,"ngIf"],[1,"timeline-line"],[1,"event-badge"],[1,"event-insumos"],[1,"insumos-header"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"insumos-title"],[1,"insumos-list"],["class","insumo-item",4,"ngFor","ngForOf"],[1,"insumo-item"],[1,"insumo-info"],[1,"insumo-name"],[1,"insumo-dose"],[1,"insumo-quantity"],[1,"event-responsible"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"event-cost"],[1,"no-events"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"no-events-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"no-events-text"]],template:function(t,d){t&1&&(e(0,"div",0),x(1,Ve,6,0,"div",1)(2,qe,3,2,"div",2),n()),t&2&&(r(),c("ngIf",d.loading),r(),c("ngIf",!d.loading&&d.trazabilidad))},dependencies:[I,F,E,k],styles:[".page-container[_ngcontent-%COMP%]{padding:1rem;max-width:1600px;margin:0 auto;background:#fafafa;min-height:100vh}@media (min-width: 768px){.page-container[_ngcontent-%COMP%]{padding:2rem}}.loading-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:3rem 2rem;text-align:center;box-shadow:0 2px 8px #0000000f}@media (min-width: 768px){.loading-card[_ngcontent-%COMP%]{padding:4rem 2rem}}.loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 1rem;color:#1a7f5a;animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (min-width: 768px){.loading-spinner[_ngcontent-%COMP%]{width:64px;height:64px;margin-bottom:1.5rem}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;font-weight:600;margin:0}@media (min-width: 768px){.loading-text[_ngcontent-%COMP%]{font-size:1.1rem}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:#fff;border-radius:16px;box-shadow:0 2px 8px #0000000f}@media (min-width: 768px){.empty-state[_ngcontent-%COMP%]{padding:5rem 2rem}}.empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 2rem;color:#d1d5db}@media (min-width: 768px){.empty-icon[_ngcontent-%COMP%]{width:120px;height:120px}}.empty-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}.empty-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#111827;margin:0 0 .75rem}@media (min-width: 768px){.empty-title[_ngcontent-%COMP%]{font-size:1.5rem}}.empty-description[_ngcontent-%COMP%]{font-size:.95rem;color:#6b7280;margin:0}.content-layout[_ngcontent-%COMP%], .periods-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.period-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 2px 8px #0000000f;overflow:hidden}.period-header[_ngcontent-%COMP%]{padding:1.5rem;background:linear-gradient(135deg,#f0f9f4,#d1fae5);border-left:5px solid #1a7f5a;display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}@media (min-width: 768px){.period-header[_ngcontent-%COMP%]{padding:2rem}}.period-header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1;min-width:0}.period-icon-wrapper[_ngcontent-%COMP%]{width:48px;height:48px;background:linear-gradient(135deg,#1a7f5a,#166649);border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 4px 12px #1a7f5a4d}@media (min-width: 768px){.period-icon-wrapper[_ngcontent-%COMP%]{width:56px;height:56px}}.period-icon[_ngcontent-%COMP%]{width:24px;height:24px;color:#fff}@media (min-width: 768px){.period-icon[_ngcontent-%COMP%]{width:28px;height:28px}}.period-info[_ngcontent-%COMP%]{flex:1;min-width:0}.period-title[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:700;color:#111827;margin:0 0 .25rem;line-height:1.3}@media (min-width: 768px){.period-title[_ngcontent-%COMP%]{font-size:1.25rem}}.period-dates[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;font-weight:600;margin:0;display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}@media (min-width: 768px){.period-dates[_ngcontent-%COMP%]{font-size:.9rem}}.date-separator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.date-arrow[_ngcontent-%COMP%]{width:16px;height:16px;color:#9ca3af}.period-status[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:999px;font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;white-space:nowrap;flex-shrink:0}.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);color:#92400e;border:1px solid #fbbf24}.status-completed[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0);color:#065f46;border:1px solid #86efac}.status-cancelled[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2,#fecaca);color:#991b1b;border:1px solid #fca5a5}.period-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;padding:1.5rem}@media (min-width: 640px){.period-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 768px){.period-stats[_ngcontent-%COMP%]{padding:2rem}}@media (min-width: 1024px){.period-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.stat-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:1rem;display:flex;align-items:center;gap:.75rem;transition:all .2s ease}.stat-item[_ngcontent-%COMP%]:hover{border-color:#1a7f5a;box-shadow:0 2px 8px #1a7f5a1f}.stat-icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#1a7f5a;flex-shrink:0}.stat-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.15rem;flex:1}.stat-label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:#6b7280}.stat-value[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:700;color:#111827;line-height:1}.stat-value-accent[_ngcontent-%COMP%]{color:#3b82f6}.stat-value-success[_ngcontent-%COMP%]{color:#10b981}.timeline-container[_ngcontent-%COMP%]{padding:0 1.5rem 1.5rem;position:relative}@media (min-width: 768px){.timeline-container[_ngcontent-%COMP%]{padding:0 2rem 2rem 4rem}}.timeline-item[_ngcontent-%COMP%]{position:relative;padding-bottom:2rem;animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}.timeline-item[_ngcontent-%COMP%]:last-child{padding-bottom:0}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.timeline-line[_ngcontent-%COMP%]{position:absolute;left:11px;top:24px;bottom:-24px;width:2px;background:linear-gradient(to bottom,#bfdbfe,#93c5fd)}@media (min-width: 768px){.timeline-line[_ngcontent-%COMP%]{left:-32px}}.timeline-dot[_ngcontent-%COMP%]{position:absolute;left:0;top:12px;width:24px;height:24px;background:linear-gradient(135deg,#3b82f6,#2563eb);border:4px solid white;border-radius:50%;box-shadow:0 0 0 3px #3b82f633,0 2px 8px #0000001a;z-index:1}@media (min-width: 768px){.timeline-dot[_ngcontent-%COMP%]{left:-43px}}.event-card[_ngcontent-%COMP%]{background:#fff;border:2px solid #e5e7eb;border-radius:16px;padding:1.5rem;margin-left:3rem;transition:all .3s ease}@media (min-width: 768px){.event-card[_ngcontent-%COMP%]{margin-left:0}}.event-card[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 8px 24px #0000001f;transform:translate(4px)}.event-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;margin-bottom:1.25rem}.event-icon-wrapper[_ngcontent-%COMP%]{width:48px;height:48px;background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}@media (min-width: 768px){.event-icon-wrapper[_ngcontent-%COMP%]{width:56px;height:56px}}.event-icon[_ngcontent-%COMP%]{width:24px;height:24px;color:#3b82f6}@media (min-width: 768px){.event-icon[_ngcontent-%COMP%]{width:28px;height:28px}}.event-info[_ngcontent-%COMP%]{flex:1;min-width:0}.event-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#111827;margin:0 0 .25rem;line-height:1.3}@media (min-width: 768px){.event-title[_ngcontent-%COMP%]{font-size:1.1rem}}.event-date[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;margin:0}.event-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;background:linear-gradient(135deg,#dbeafe,#bfdbfe);color:#1e40af;border-radius:999px;font-size:.75rem;font-weight:700;white-space:nowrap;flex-shrink:0}.event-insumos[_ngcontent-%COMP%]{margin-top:1.25rem;background:#f9fafb;border-radius:12px;padding:1rem}.insumos-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.75rem;color:#374151}.insumos-title[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em}.insumos-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.insumo-item[_ngcontent-%COMP%]{background:#fff;padding:.85rem 1rem;border-radius:10px;display:flex;justify-content:space-between;align-items:center;gap:1rem;box-shadow:0 1px 3px #0000000f}.insumo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;flex:1;min-width:0}.insumo-name[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:#111827}.insumo-dose[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.insumo-quantity[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:#111827;white-space:nowrap}.event-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1.25rem;padding-top:1.25rem;border-top:1px solid #e5e7eb;font-size:.85rem;gap:1rem;flex-wrap:wrap}.event-responsible[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#6b7280;font-weight:500}.event-cost[_ngcontent-%COMP%]{font-weight:700;color:#10b981}.no-events[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;background:#f9fafb;border-radius:12px;border:2px dashed #d1d5db}.no-events-icon[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 1rem;color:#d1d5db}.no-events-text[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;margin:0}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 2px 8px #0000000f;padding:1.5rem;border:2px solid #e5e7eb}@media (min-width: 768px){.summary-card[_ngcontent-%COMP%]{padding:2rem}}.summary-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem;padding-bottom:1.5rem;border-bottom:2px solid #e5e7eb}.summary-icon[_ngcontent-%COMP%]{width:28px;height:28px;color:#1a7f5a;flex-shrink:0}@media (min-width: 768px){.summary-icon[_ngcontent-%COMP%]{width:32px;height:32px}}.summary-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#111827;margin:0}@media (min-width: 768px){.summary-title[_ngcontent-%COMP%]{font-size:1.5rem}}.summary-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.5rem}@media (min-width: 640px){.summary-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1024px){.summary-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.summary-stat[_ngcontent-%COMP%]{padding:1.5rem;border-radius:16px;text-align:center;display:flex;flex-direction:column;align-items:center;gap:.75rem;transition:transform .3s ease}.summary-stat[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.summary-stat-blue[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border:2px solid #93c5fd}.summary-stat-purple[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e9d5ff,#d8b4fe);border:2px solid #c084fc}.summary-stat-green[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0);border:2px solid #86efac}.summary-stat-yellow[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid #fbbf24}.summary-stat-icon[_ngcontent-%COMP%]{width:32px;height:32px}@media (min-width: 768px){.summary-stat-icon[_ngcontent-%COMP%]{width:40px;height:40px}}.summary-stat-blue[_ngcontent-%COMP%]   .summary-stat-icon[_ngcontent-%COMP%]{color:#3b82f6}.summary-stat-purple[_ngcontent-%COMP%]   .summary-stat-icon[_ngcontent-%COMP%]{color:#a855f7}.summary-stat-green[_ngcontent-%COMP%]   .summary-stat-icon[_ngcontent-%COMP%]{color:#10b981}.summary-stat-yellow[_ngcontent-%COMP%]   .summary-stat-icon[_ngcontent-%COMP%]{color:#f59e0b}.summary-stat-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:#374151}@media (min-width: 768px){.summary-stat-label[_ngcontent-%COMP%]{font-size:.8rem}}.summary-stat-value[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:900;line-height:1;letter-spacing:-.025em}@media (min-width: 768px){.summary-stat-value[_ngcontent-%COMP%]{font-size:3rem}}.summary-stat-value-sm[_ngcontent-%COMP%]{font-size:1.5rem}@media (min-width: 768px){.summary-stat-value-sm[_ngcontent-%COMP%]{font-size:1.75rem}}.summary-stat-blue[_ngcontent-%COMP%]   .summary-stat-value[_ngcontent-%COMP%]{color:#3b82f6}.summary-stat-purple[_ngcontent-%COMP%]   .summary-stat-value[_ngcontent-%COMP%]{color:#a855f7}.summary-stat-green[_ngcontent-%COMP%]   .summary-stat-value[_ngcontent-%COMP%]{color:#10b981}.summary-stat-yellow[_ngcontent-%COMP%]   .summary-stat-value[_ngcontent-%COMP%]{color:#f59e0b}.summary-stat-unit[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}@media (min-width: 768px){.summary-stat-unit[_ngcontent-%COMP%]{font-size:1.5rem}}.w-4[_ngcontent-%COMP%]{width:1rem;height:1rem}"]})};function Ye(o,i){if(o&1&&(e(0,"div",15),m(),e(1,"svg",16),s(2,"path",42)(3,"path",43),n(),g(),e(4,"div")(5,"span",18),a(6,"Ubicaci\xF3n"),n(),e(7,"span",19),a(8),n()()()),o&2){let t=p(2);r(8),h(t.parcela.ubicacion)}}function Ue(o,i){if(o&1&&(e(0,"div",15),m(),e(1,"svg",16),s(2,"path",24),n(),g(),e(3,"div")(4,"span",18),a(5,"Tipo de Suelo"),n(),e(6,"span",19),a(7),n()()()),o&2){let t=p(2);r(7),h(t.parcela.tipoSuelo)}}function Xe(o,i){if(o&1&&(e(0,"div",15),m(),e(1,"svg",16),s(2,"path",44),n(),g(),e(3,"div")(4,"span",18),a(5,"Sistema de Riego"),n(),e(6,"span",19),a(7),n()()()),o&2){let t=p(2);r(7),h(t.parcela.sistemaRiego)}}function Je(o,i){o&1&&(e(0,"div",48),m(),e(1,"svg",49),s(2,"path",24),n(),g(),e(3,"h3",50),a(4,"No hay per\xEDodos de siembra"),n(),e(5,"p",51),a(6,"Inicia tu primer per\xEDodo de siembra para comenzar a registrar las actividades de esta parcela"),n()())}function Ke(o,i){if(o&1&&(e(0,"div",61)(1,"span",62),a(2,"Rend. Real"),n(),e(3,"span",63),a(4),n()()),o&2){let t=p().$implicit;r(4),b("",t.rendimientoReal," ton")}}function Qe(o,i){if(o&1&&(e(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3",57),a(4),n(),e(5,"span",58),a(6),n()(),e(7,"span",59),a(8),n()(),e(9,"div",60)(10,"div",61)(11,"span",62),a(12,"Hect\xE1reas"),n(),e(13,"span",63),a(14),n()(),e(15,"div",61)(16,"span",62),a(17,"Rend. Esperado"),n(),e(18,"span",63),a(19),n()(),x(20,Ke,5,1,"div",64),e(21,"div",61)(22,"span",62),a(23,"Costo Total"),n(),e(24,"span",65),a(25),n()()()()),o&2){let t=i.$implicit,d=p(4);r(4),h(t.cultivo==null?null:t.cultivo.nombre),r(2),h(d.formatearFecha(t.fechaInicio)),r(),c("ngClass",d.getEstadoPeriodoColor(t.estado)),r(),b(" ",t.estado," "),r(6),h(d.formatearHectareas(t.hectareasSembradas)),r(5),b("",t.rendimientoEsperado||0," ton"),r(),c("ngIf",t.rendimientoReal),r(5),h(d.formatearCosto(t.costoTotal))}}function Ze(o,i){if(o&1&&(e(0,"div",52),x(1,Qe,26,8,"div",53),n()),o&2){let t=p(3);r(),c("ngForOf",t.periodos)}}function $e(o,i){if(o&1&&(e(0,"div",45),x(1,Je,7,0,"div",46)(2,Ze,2,1,"div",47),n()),o&2){let t=p(2);r(),c("ngIf",t.periodos.length===0),r(),c("ngIf",t.periodos.length>0)}}function et(o,i){o&1&&(e(0,"div",48),m(),e(1,"svg",49),s(2,"path",29),n(),g(),e(3,"h3",50),a(4,"No hay aplicaciones registradas"),n(),e(5,"p",51),a(6,"Registra las aplicaciones de insumos realizadas en esta parcela"),n()())}function tt(o,i){if(o&1&&(e(0,"li"),a(1),n()),o&2){let t=i.$implicit;r(),D(" ",t.insumo==null?null:t.insumo.nombre,": ",t.cantidad," ",t.unidadMedida," ")}}function nt(o,i){if(o&1&&(e(0,"span",74),m(),e(1,"svg",75),s(2,"path",76),n(),a(3),n()),o&2){let t=p().$implicit;r(3),b(" ",t.responsable," ")}}function it(o,i){if(o&1&&(e(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3",57),a(4),n(),e(5,"span",58),a(6),n()(),e(7,"span",66),a(8),n()(),e(9,"div",67)(10,"span",68),a(11,"Insumos aplicados:"),n(),e(12,"ul",69),x(13,tt,2,3,"li",70),n()(),e(14,"div",71),x(15,nt,4,1,"span",72),e(16,"span",73),a(17),n()()()),o&2){let t=i.$implicit,d=p(4);r(4),h(t.tipoAplicacion),r(2),h(d.formatearFecha(t.fecha)),r(2),b(" ",d.formatearHectareas(t.hectareasAplicadas)," "),r(5),c("ngForOf",t.insumos),r(2),c("ngIf",t.responsable),r(2),h(d.formatearCosto(t.costoTotal))}}function at(o,i){if(o&1&&(e(0,"div",52),x(1,it,18,6,"div",53),n()),o&2){let t=p(3);r(),c("ngForOf",t.aplicaciones)}}function ot(o,i){if(o&1&&(e(0,"div",45),x(1,et,7,0,"div",46)(2,at,2,1,"div",47),n()),o&2){let t=p(2);r(),c("ngIf",t.aplicaciones.length===0),r(),c("ngIf",t.aplicaciones.length>0)}}function rt(o,i){if(o&1&&(e(0,"div",45),s(1,"app-trazabilidad",77),n()),o&2){let t=p(2);r(),c("parcelaId",t.parcela.id)}}function lt(o,i){if(o&1){let t=y();e(0,"div",3)(1,"div",4)(2,"div",5)(3,"a",6),m(),e(4,"svg",7),s(5,"path",8),n()(),g(),e(6,"div",9)(7,"h1",10),a(8),n(),e(9,"span",11),a(10),n()(),e(11,"span",12),a(12),n()(),e(13,"div",13)(14,"div",14)(15,"div",15),m(),e(16,"svg",16),s(17,"path",17),n(),g(),e(18,"div")(19,"span",18),a(20,"Superficie"),n(),e(21,"span",19),a(22),n()()(),x(23,Ye,9,1,"div",20)(24,Ue,8,1,"div",20)(25,Xe,8,1,"div",20),n()(),e(26,"div",21)(27,"div",22),m(),e(28,"svg",23),s(29,"path",24),n(),g(),e(30,"div",25)(31,"span",26),a(32,"Per\xEDodos Activos"),n(),e(33,"span",27),a(34),n()()(),e(35,"div",28),m(),e(36,"svg",23),s(37,"path",29),n(),g(),e(38,"div",25)(39,"span",26),a(40,"Total Aplicaciones"),n(),e(41,"span",27),a(42),n()()(),e(43,"div",30),m(),e(44,"svg",23),s(45,"path",31),n(),g(),e(46,"div",25)(47,"span",26),a(48,"Costo Total"),n(),e(49,"span",27),a(50),n()()()(),e(51,"div",32)(52,"button",33),v("click",function(){u(t);let l=p();return _(l.abrirFormPeriodo())}),m(),e(53,"svg",7),s(54,"path",24),n(),g(),e(55,"span"),a(56,"Iniciar Per\xEDodo"),n()(),e(57,"button",34),v("click",function(){u(t);let l=p();return _(l.abrirFormAplicacion())}),m(),e(58,"svg",7),s(59,"path",29),n(),g(),e(60,"span"),a(61,"Registrar Aplicaci\xF3n"),n()()()(),e(62,"div",35)(63,"div",36)(64,"button",37),v("click",function(){u(t);let l=p();return _(l.cambiarTab("periodos"))}),m(),e(65,"svg",7),s(66,"path",38),n(),g(),e(67,"span"),a(68,"Per\xEDodos de Siembra"),n()(),e(69,"button",37),v("click",function(){u(t);let l=p();return _(l.cambiarTab("aplicaciones"))}),m(),e(70,"svg",7),s(71,"path",29),n(),g(),e(72,"span"),a(73,"Aplicaciones"),n()(),e(74,"button",37),v("click",function(){u(t);let l=p();return _(l.cambiarTab("trazabilidad"))}),m(),e(75,"svg",7),s(76,"path",39),n(),g(),e(77,"span"),a(78,"Trazabilidad"),n()()(),e(79,"div",40),x(80,$e,3,2,"div",41)(81,ot,3,2,"div",41)(82,rt,2,1,"div",41),n()()()}if(o&2){let t=p();r(8),h(t.parcela.nombre),r(2),h(t.parcela.codigo),r(),c("ngClass",t.getEstadoColor(t.parcela.estado)),r(),b(" ",t.parcela.estado," "),r(10),h(t.formatearHectareas(t.parcela.superficieHa)),r(),c("ngIf",t.parcela.ubicacion),r(),c("ngIf",t.parcela.tipoSuelo),r(),c("ngIf",t.parcela.sistemaRiego),r(9),h(t.periodosActivos),r(8),h(t.totalAplicaciones),r(8),h(t.formatearCosto(t.costoTotal)),r(7),c("disabled",t.periodosActivos===0),r(7),w("tab-active",t.tabActiva==="periodos"),r(5),w("tab-active",t.tabActiva==="aplicaciones"),r(5),w("tab-active",t.tabActiva==="trazabilidad"),r(6),c("ngIf",t.tabActiva==="periodos"),r(),c("ngIf",t.tabActiva==="aplicaciones"),r(),c("ngIf",t.tabActiva==="trazabilidad")}}function dt(o,i){o&1&&(e(0,"div",78),m(),e(1,"svg",79),s(2,"circle",80)(3,"path",81),n(),g(),e(4,"p",82),a(5,"Cargando detalles..."),n()())}function st(o,i){if(o&1){let t=y();e(0,"app-form-periodo",83),v("onClose",function(){u(t);let l=p();return _(l.cerrarFormPeriodo())})("onSave",function(){u(t);let l=p();return _(l.cerrarFormPeriodo())}),n()}if(o&2){let t=p();c("parcelaId",t.parcela==null?null:t.parcela.id)}}function ct(o,i){if(o&1){let t=y();e(0,"app-form-aplicacion",83),v("onClose",function(){u(t);let l=p();return _(l.cerrarFormAplicacion())})("onSave",function(){u(t);let l=p();return _(l.cerrarFormAplicacion())}),n()}if(o&2){let t=p();c("parcelaId",t.parcela==null?null:t.parcela.id)}}var me=class o{route=S(oe);router=S(re);parcelasService=S(T);parcela;periodos=[];aplicaciones=[];loading=!1;tabActiva="periodos";mostrarFormPeriodo=!1;mostrarFormAplicacion=!1;periodosActivos=0;totalAplicaciones=0;costoTotal=0;ngOnInit(){let i=Number(this.route.snapshot.paramMap.get("id"));i&&this.cargarParcela(i)}cargarParcela(i){this.loading=!0,this.parcelasService.getParcelaById(i).subscribe({next:t=>{this.parcela=t,this.cargarPeriodos(),this.cargarAplicaciones(),this.loading=!1},error:t=>{console.error("Error al cargar parcela:",t),alert("Error al cargar la parcela"),this.router.navigate(["/parcelas"])}})}cargarPeriodos(){this.parcela&&this.parcelasService.getPeriodosSiembra(this.parcela.id).subscribe({next:i=>{this.periodos=i,this.periodosActivos=i.filter(t=>t.estado==="En Curso").length,this.calcularEstadisticas()},error:i=>console.error("Error al cargar per\xEDodos:",i)})}cargarAplicaciones(){this.parcela&&this.parcelasService.getAplicaciones(this.parcela.id).subscribe({next:i=>{this.aplicaciones=i,this.totalAplicaciones=i.length,this.calcularEstadisticas()},error:i=>console.error("Error al cargar aplicaciones:",i)})}calcularEstadisticas(){this.costoTotal=this.aplicaciones.reduce((i,t)=>i+t.costoTotal,0)}cambiarTab(i){this.tabActiva=i}abrirFormPeriodo(){this.mostrarFormPeriodo=!0}cerrarFormPeriodo(){this.mostrarFormPeriodo=!1,this.cargarPeriodos()}abrirFormAplicacion(){this.mostrarFormAplicacion=!0}cerrarFormAplicacion(){this.mostrarFormAplicacion=!1,this.cargarAplicaciones()}getEstadoColor(i){return se(i)}getEstadoPeriodoColor(i){return ce(i)}formatearHectareas(i){return K(i)}formatearCosto(i){return Q(i)}formatearFecha(i){return new Date(i).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=O({type:o,selectors:[["app-detalle-parcela"]],decls:4,vars:4,consts:[["class","page-container",4,"ngIf"],["class","loading-page",4,"ngIf"],[3,"parcelaId","onClose","onSave",4,"ngIf"],[1,"page-container"],[1,"page-header-detail"],[1,"header-top"],["routerLink","/parcelas",1,"btn-back"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"header-title-section"],[1,"detail-title"],[1,"detail-code"],[1,"status-badge",3,"ngClass"],[1,"info-card"],[1,"info-grid"],[1,"info-item"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"info-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"],[1,"info-label"],[1,"info-value"],["class","info-item",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","stat-green"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"stat-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],[1,"stat-content"],[1,"stat-label"],[1,"stat-value"],[1,"stat-card","stat-blue"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"stat-card","stat-yellow"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"actions-row"],[1,"btn-action","btn-action-green",3,"click"],[1,"btn-action","btn-action-blue",3,"click","disabled"],[1,"tabs-container"],[1,"tabs-header"],[1,"tab-button",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"tabs-content"],["class","tab-panel",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"],[1,"tab-panel"],["class","empty-state",4,"ngIf"],["class","items-list",4,"ngIf"],[1,"empty-state"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"empty-icon"],[1,"empty-title"],[1,"empty-description"],[1,"items-list"],["class","item-card",4,"ngFor","ngForOf"],[1,"item-card"],[1,"item-header"],[1,"item-header-left"],[1,"item-title"],[1,"item-date"],[1,"item-badge",3,"ngClass"],[1,"item-stats"],[1,"item-stat"],[1,"item-stat-label"],[1,"item-stat-value"],["class","item-stat",4,"ngIf"],[1,"item-stat-value","item-stat-cost"],[1,"item-badge","item-badge-blue"],[1,"insumos-section"],[1,"insumos-title"],[1,"insumos-list"],[4,"ngFor","ngForOf"],[1,"item-footer"],["class","item-responsible",4,"ngIf"],[1,"item-cost"],[1,"item-responsible"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[3,"parcelaId"],[1,"loading-page"],["fill","none","viewBox","0 0 24 24",1,"loading-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"loading-text"],[3,"onClose","onSave","parcelaId"]],template:function(t,d){t&1&&x(0,lt,83,21,"div",0)(1,dt,6,0,"div",1)(2,st,1,1,"app-form-periodo",2)(3,ct,1,1,"app-form-aplicacion",2),t&2&&(c("ngIf",d.parcela),r(),c("ngIf",d.loading),r(),c("ngIf",d.mostrarFormPeriodo),r(),c("ngIf",d.mostrarFormAplicacion))},dependencies:[I,F,E,k,le,Z,$,ee],styles:[".page-container[_ngcontent-%COMP%]{padding:1rem;max-width:1400px;margin:0 auto;background:#fafafa;min-height:100vh}@media (min-width: 768px){.page-container[_ngcontent-%COMP%]{padding:2rem}}.page-header-detail[_ngcontent-%COMP%]{margin-bottom:2rem}.header-top[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;margin-bottom:1.5rem}.btn-back[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;background:#fff;border:1px solid #e5e7eb;display:flex;align-items:center;justify-content:center;color:#6b7280;text-decoration:none;transition:all .2s ease;flex-shrink:0}.btn-back[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db;color:#111827}.header-title-section[_ngcontent-%COMP%]{flex:1;min-width:0}.detail-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827;margin:0 0 .25rem;line-height:1.2}@media (min-width: 768px){.detail-title[_ngcontent-%COMP%]{font-size:2rem}}.detail-code[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.status-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:999px;font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;white-space:nowrap;flex-shrink:0;border:1px solid}.estado-activo[_ngcontent-%COMP%]{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}.estado-inactivo[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b;border-color:#fecaca}.estado-en-preparacion[_ngcontent-%COMP%]{background:#fffbeb;color:#92400e;border-color:#fde68a}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014;padding:1.5rem;margin-bottom:1.5rem}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.25rem}@media (min-width: 640px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1024px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.875rem}.info-icon[_ngcontent-%COMP%]{width:20px;height:20px;color:#1a7f5a;flex-shrink:0}.info-item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;flex:1;min-width:0}.info-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.info-value[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:#111827;line-height:1.2}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.25rem;margin-bottom:1.5rem}@media (min-width: 640px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 1024px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014;padding:1.25rem;display:flex;align-items:center;gap:1rem;border-left:4px solid}.stat-green[_ngcontent-%COMP%]{border-left-color:#10b981}.stat-blue[_ngcontent-%COMP%]{border-left-color:#3b82f6}.stat-yellow[_ngcontent-%COMP%]{border-left-color:#f59e0b}.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px;flex-shrink:0}.stat-green[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#10b981}.stat-blue[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#3b82f6}.stat-yellow[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#f59e0b}.stat-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#6b7280}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827;line-height:1}.actions-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-bottom:2rem}@media (min-width: 640px){.actions-row[_ngcontent-%COMP%]{flex-direction:row}}.btn-action[_ngcontent-%COMP%]{flex:1;padding:.875rem 1.25rem;border-radius:8px;font-weight:600;font-size:.95rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem;transition:all .2s ease;border:none;color:#fff}.btn-action-green[_ngcontent-%COMP%]{background:#1a7f5a}.btn-action-green[_ngcontent-%COMP%]:hover{background:#166649}.btn-action-blue[_ngcontent-%COMP%]{background:#3b82f6}.btn-action-blue[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.btn-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.tabs-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014;overflow:hidden}.tabs-header[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e5e7eb;overflow-x:auto;scrollbar-width:none}.tabs-header[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tab-button[_ngcontent-%COMP%]{flex:1;min-width:fit-content;padding:1rem 1.5rem;background:transparent;border:none;border-bottom:2px solid transparent;color:#6b7280;font-weight:600;font-size:.9rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem;transition:all .2s ease;white-space:nowrap}@media (max-width: 639px){.tab-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}.tab-button[_ngcontent-%COMP%]:hover{color:#111827;background:#f9fafb}.tab-active[_ngcontent-%COMP%]{color:#1a7f5a;border-bottom-color:#1a7f5a;background:transparent}.tabs-content[_ngcontent-%COMP%]{padding:1.5rem}@media (min-width: 768px){.tabs-content[_ngcontent-%COMP%]{padding:2rem}}.tab-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-icon[_ngcontent-%COMP%]{width:64px;height:64px;margin:0 auto 1.5rem;color:#d1d5db}.empty-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin:0 0 .5rem}.empty-description[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;margin:0;line-height:1.5}.items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.item-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:1.25rem;transition:all .2s ease}.item-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000014;border-color:#d1d5db}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;margin-bottom:1rem}.item-header-left[_ngcontent-%COMP%]{flex:1;min-width:0}.item-title[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:600;color:#111827;margin:0 0 .25rem}.item-date[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280}.item-badge[_ngcontent-%COMP%]{padding:.375rem .875rem;border-radius:999px;font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.05em;white-space:nowrap;flex-shrink:0;border:1px solid}.item-badge-blue[_ngcontent-%COMP%]{background:#eff6ff;color:#1e40af;border-color:#bfdbfe}.periodo-en-curso[_ngcontent-%COMP%]{background:#fffbeb;color:#92400e;border-color:#fde68a}.periodo-finalizado[_ngcontent-%COMP%]{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}.periodo-cancelado[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b;border-color:#fecaca}.item-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}@media (min-width: 640px){.item-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.item-stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.item-stat-label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.item-stat-value[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:#111827}.item-stat-cost[_ngcontent-%COMP%]{color:#10b981}.insumos-section[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #f3f4f6}.insumos-title[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#374151;margin-bottom:.5rem;display:block}.insumos-list[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem;display:flex;flex-direction:column;gap:.375rem}.insumos-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;line-height:1.4}.item-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:1rem;border-top:1px solid #f3f4f6;gap:1rem}.item-responsible[_ngcontent-%COMP%]{font-size:.85rem;color:#6b7280;display:flex;align-items:center;gap:.5rem}.item-cost[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;color:#111827;white-space:nowrap}.loading-page[_ngcontent-%COMP%]{padding:4rem 2rem;text-align:center;max-width:1400px;margin:0 auto}.loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 auto 1rem;color:#1a7f5a;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:.95rem;color:#6b7280;font-weight:500;margin:0}.w-4[_ngcontent-%COMP%]{width:1rem;height:1rem}.w-5[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}@media (max-width: 639px){.header-top[_ngcontent-%COMP%]{flex-wrap:wrap}.status-badge[_ngcontent-%COMP%]{width:100%;text-align:center}.tabs-content[_ngcontent-%COMP%]{padding:1.25rem}.item-footer[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})};export{me as DetalleParcelaComponent};
