import{a as i}from"./chunk-2F5RLYLV.js";import{L as o,Q as d,dc as p,ec as l,n as r}from"./chunk-PCLR6J3H.js";var u=class s{http=d(l);apiUrl=`${i.apiUrl}/ordenes-aplicacion`;createOrden(e){return this.http.post(this.apiUrl,e).pipe(r(a=>a.data))}getOrdenes(e){let a=new p;return e&&(e.parcelaId&&(a=a.set("parcelaId",e.parcelaId.toString())),e.recetaId&&(a=a.set("recetaId",e.recetaId.toString())),e.estado&&(a=a.set("estado",e.estado)),e.fechaDesde&&(a=a.set("fechaDesde",e.fechaDesde.toISOString())),e.fechaHasta&&(a=a.set("fechaHasta",e.fechaHasta.toISOString())),e.search&&(a=a.set("search",e.search))),this.http.get(this.apiUrl,{params:a}).pipe(r(t=>t.data))}getOrdenById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(r(a=>a.data))}updateOrden(e,a){return this.http.put(`${this.apiUrl}/${e}`,a).pipe(r(t=>t.data))}deleteOrden(e){return this.http.delete(`${this.apiUrl}/${e}`)}cerrarOrden(e){return this.http.post(`${this.apiUrl}/${e}/cerrar`,{}).pipe(r(a=>a.data))}cancelarOrden(e,a){return this.http.post(`${this.apiUrl}/${e}/cancelar`,{motivo:a}).pipe(r(t=>t.data))}validarStock(e,a){return this.http.post(`${this.apiUrl}/validar-stock`,{recetaId:e,hectareas:a}).pipe(r(t=>t.data))}getParcelas(){return this.http.get(`${i.apiUrl}/parcelas`).pipe(r(e=>e.data))}getRecetas(){return this.http.get(`${i.apiUrl}/recetas`).pipe(r(e=>e.data))}getRecetaById(e){return this.http.get(`${i.apiUrl}/recetas/${e}`).pipe(r(a=>a.data))}calcularConsumo(e,a){return e*a}calcularCostoTotal(e){return!e.detalles||e.detalles.length===0?0:e.detalles.reduce((a,t)=>a+t.costoTotal,0)}calcularDetallesOrden(e,a){return!e.detalles||e.detalles.length===0?[]:e.detalles.map(t=>{let n=this.calcularConsumo(t.dosisPorHectarea,a),c=t.insumo?.costoUnitario||0;return{insumoId:t.insumoId,insumo:t.insumo,cantidadCalculada:n,unidadMedida:t.unidadMedida,costoUnitario:c,costoTotal:n*c}})}getHistorialParcela(e){return this.http.get(`${this.apiUrl}/historial/parcela/${e}`).pipe(r(a=>a.data))}getEstadisticasPeriodo(e,a){let t=new p().set("fechaInicio",e.toISOString()).set("fechaFin",a.toISOString());return this.http.get(`${this.apiUrl}/estadisticas`,{params:t}).pipe(r(n=>n.data))}static \u0275fac=function(a){return new(a||s)};static \u0275prov=o({token:s,factory:s.\u0275fac,providedIn:"root"})};export{u as a};
