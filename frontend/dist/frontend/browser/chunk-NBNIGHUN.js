import"./chunk-BYXBJQAS.js";import{a as N}from"./chunk-KEZWZJXI.js";import"./chunk-2F5RLYLV.js";import{b as y,d as D,e as V,g as z}from"./chunk-YAFIELCV.js";import{b as U,d as T,g as I,j as L,m as j,n as H,o as W,q as G,t as B}from"./chunk-B4I6E7XD.js";import{$a as b,Ga as O,Ka as C,Q as v,Ra as h,Sa as e,Ta as t,Ua as s,V as f,Vb as E,W as u,X as d,Y as c,Zb as k,_a as S,bb as g,ib as w,kb as i,lb as P,pb as _,qa as l,qb as x,rb as M}from"./chunk-PCLR6J3H.js";import"./chunk-FDERIQAA.js";function R(m,r){m&1&&(e(0,"div",15),d(),e(1,"svg",16),s(2,"circle",17)(3,"path",18),t(),c(),e(4,"p",19),i(5,"Cargando usuario..."),t()())}function F(m,r){if(m&1&&(e(0,"div",20),d(),e(1,"svg",21),s(2,"path",22),t(),c(),e(3,"span"),i(4),t()()),m&2){let n=g();l(4),P(n.errorMessage)}}function q(m,r){m&1&&(d(),e(0,"svg",3),s(1,"path",63),t())}function J(m,r){m&1&&(d(),e(0,"svg",64),s(1,"circle",17)(2,"path",18),t())}function Y(m,r){if(m&1){let n=S();e(0,"div",23)(1,"div",24)(2,"div",25)(3,"div",26),i(4,"1"),t(),e(5,"h2",27),i(6,"Informaci\xF3n Personal"),t()(),e(7,"div",28)(8,"div",29)(9,"label",30),d(),e(10,"svg",31),s(11,"path",32),t(),i(12," Nombre Completo "),t(),c(),e(13,"input",33),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.name,o)||(a.formData.name=o),u(o)}),t()(),e(14,"div",29)(15,"label",30),d(),e(16,"svg",31),s(17,"path",34),t(),i(18," Correo Electr\xF3nico "),t(),c(),e(19,"input",35),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.email,o)||(a.formData.email=o),u(o)}),t()()()(),e(20,"div",24)(21,"div",25)(22,"div",26),i(23,"2"),t(),e(24,"h2",27),i(25,"Seguridad"),t()(),e(26,"div",28)(27,"div",29)(28,"label",30),d(),e(29,"svg",31),s(30,"path",36),t(),i(31," Nueva Contrase\xF1a (Opcional) "),t(),c(),e(32,"input",37),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.password,o)||(a.formData.password=o),u(o)}),t(),e(33,"p",38),i(34,"Solo completa este campo si deseas cambiar la contrase\xF1a"),t()(),e(35,"div",29)(36,"label",30),d(),e(37,"svg",31),s(38,"path",39),t(),i(39," Rol del Usuario "),t(),c(),e(40,"div",40)(41,"select",41),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.role,o)||(a.formData.role=o),u(o)}),e(42,"option",42),i(43,"Administrador"),t(),e(44,"option",43),i(45,"Operador"),t()(),d(),e(46,"svg",44),s(47,"path",45),t()(),c(),e(48,"p",38)(49,"strong"),i(50,"Administrador:"),t(),i(51," Acceso completo al sistema "),s(52,"br"),e(53,"strong"),i(54,"Operador:"),t(),i(55," Solo puede ejecutar aplicaciones "),t()()()(),e(56,"div",24)(57,"div",25)(58,"div",26),i(59,"3"),t(),e(60,"h2",27),i(61,"Estado del Usuario"),t()(),e(62,"div",46)(63,"div",29)(64,"label",30),d(),e(65,"svg",31),s(66,"path",47),t(),i(67," Estado "),t(),c(),e(68,"div",48)(69,"label",49)(70,"input",50),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.activo,o)||(a.formData.activo=o),u(o)}),t(),e(71,"div",51),d(),e(72,"svg",52),s(73,"path",47),t(),c(),e(74,"div",53)(75,"span",54),i(76,"Activo"),t(),e(77,"span",55),i(78,"El usuario puede iniciar sesi\xF3n"),t()()()(),e(79,"label",49)(80,"input",50),M("ngModelChange",function(o){f(n);let a=g();return x(a.formData.activo,o)||(a.formData.activo=o),u(o)}),t(),e(81,"div",51),d(),e(82,"svg",52),s(83,"path",56),t(),c(),e(84,"div",53)(85,"span",54),i(86,"Inactivo"),t(),e(87,"span",55),i(88,"El usuario no puede acceder al sistema"),t()()()()()()()(),e(89,"div",57)(90,"button",58),b("click",function(){f(n);let o=g();return u(o.cancelar())}),d(),e(91,"svg",3),s(92,"path",59),t(),c(),e(93,"span"),i(94,"Cancelar"),t()(),e(95,"button",60),b("click",function(){f(n);let o=g();return u(o.guardar())}),C(96,q,2,0,"svg",61)(97,J,3,0,"svg",62),e(98,"span"),i(99),t()()()()}if(m&2){let n=g();l(13),_("ngModel",n.formData.name),l(6),_("ngModel",n.formData.email),l(13),_("ngModel",n.formData.password),l(9),_("ngModel",n.formData.role),l(28),w("radio-selected",n.formData.activo===!0),l(),h("value",!0),_("ngModel",n.formData.activo),l(9),w("radio-selected",n.formData.activo===!1),l(),h("value",!1),_("ngModel",n.formData.activo),l(15),h("disabled",n.saving),l(),h("ngIf",!n.saving),l(),h("ngIf",n.saving),l(2),P(n.saving?"Guardando...":"Guardar Cambios")}}var A=class m{userService=v(N);router=v(D);route=v(y);userId;formData={name:"",email:"",role:"user",activo:!0,password:""};loading=!1;saving=!1;errorMessage="";ngOnInit(){if(this.userId=Number(this.route.snapshot.paramMap.get("id")),!this.userId||isNaN(this.userId)){this.errorMessage="ID de usuario inv\xE1lido";return}this.loadUsuario()}loadUsuario(){this.loading=!0,this.errorMessage="",this.userService.getUsuario(this.userId).subscribe({next:r=>{console.log("Usuario cargado:",r),this.formData={name:r.name,email:r.email,role:r.role,activo:r.activo!==!1,password:""},console.log("FormData inicializado:",this.formData),this.loading=!1},error:r=>{console.error("Error al cargar usuario:",r),this.errorMessage="No se pudo cargar el usuario",this.loading=!1}})}guardar(){if(!this.formData.name||!this.formData.email){this.errorMessage="Por favor completa todos los campos obligatorios";return}if(!this.validateEmail(this.formData.email)){this.errorMessage="Por favor ingresa un email v\xE1lido";return}this.saving=!0,this.errorMessage="";let r={name:this.formData.name,email:this.formData.email,role:this.formData.role,activo:this.formData.activo===!0};this.formData.password&&this.formData.password.trim()!==""&&(r.password=this.formData.password),console.log("Enviando payload:",r),this.userService.actualizarUsuario(this.userId,r).subscribe({next:n=>{console.log("Usuario actualizado:",n),this.router.navigate(["/usuarios"])},error:n=>{console.error("Error al actualizar usuario:",n),this.errorMessage=n.error?.message||"Error al actualizar el usuario",this.saving=!1}})}cancelar(){confirm("\xBFEst\xE1s seguro de cancelar? Los cambios no guardados se perder\xE1n.")&&this.router.navigate(["/usuarios"])}validateEmail(r){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)}static \u0275fac=function(n){return new(n||m)};static \u0275cmp=O({type:m,selectors:[["app-editar-usuario"]],decls:19,vars:3,consts:[[1,"editar-container"],[1,"page-header"],["routerLink","/usuarios",1,"btn-back"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"header-content"],[1,"header-icon-wrapper"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"header-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"header-text"],[1,"page-title"],[1,"page-subtitle"],["class","loading-container",4,"ngIf"],["class","alert-error",4,"ngIf"],["class","form-card",4,"ngIf"],[1,"loading-container"],["fill","none","viewBox","0 0 24 24",1,"loading-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"loading-text"],[1,"alert-error"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"alert-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"form-card"],[1,"form-section"],[1,"section-header"],[1,"section-badge"],[1,"section-title"],[1,"form-grid"],[1,"form-group"],[1,"form-label"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"label-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["type","text","placeholder","Ej: Juan P\xE9rez","required","",1,"form-input",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],["type","email","placeholder","usuario@ejemplo.com","required","",1,"form-input",3,"ngModelChange","ngModel"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],["type","password","placeholder","Dejar vac\xEDo para no cambiar",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-hint"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],[1,"select-wrapper"],[1,"form-select",3,"ngModelChange","ngModel"],["value","admin"],["value","user"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"select-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"form-grid","form-grid-full"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"radio-group"],[1,"radio-option"],["type","radio","name","estado",1,"radio-input",3,"ngModelChange","value","ngModel"],[1,"radio-content"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"radio-icon"],[1,"radio-text"],[1,"radio-title"],[1,"radio-description"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"form-actions"],[1,"btn-cancel",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"btn-save",3,"click","disabled"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-5 h-5 animate-spin","fill","none","viewBox","0 0 24 24",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"]],template:function(n,p){n&1&&(e(0,"div",0)(1,"div",1)(2,"button",2),d(),e(3,"svg",3),s(4,"path",4),t(),c(),e(5,"span"),i(6,"Volver"),t()(),e(7,"div",5)(8,"div",6),d(),e(9,"svg",7),s(10,"path",8),t()(),c(),e(11,"div",9)(12,"h1",10),i(13,"Editar Usuario"),t(),e(14,"p",11),i(15,"Actualiza la informaci\xF3n del usuario"),t()()()(),C(16,R,6,0,"div",12)(17,F,5,1,"div",13)(18,Y,100,16,"div",14),t()),n&2&&(l(16),h("ngIf",p.loading),l(),h("ngIf",p.errorMessage&&!p.loading),l(),h("ngIf",!p.loading))},dependencies:[k,E,B,H,W,U,j,L,T,G,I,z,V],styles:[".editar-container[_ngcontent-%COMP%]{padding:1rem;max-width:1200px;margin:0 auto;min-height:100vh}@media (min-width: 768px){.editar-container[_ngcontent-%COMP%]{padding:2rem}}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.btn-back[_ngcontent-%COMP%]{padding:.625rem 1rem;background:#fff;color:#6b7280;border:1px solid #e5e7eb;border-radius:8px;font-weight:600;font-size:.9rem;cursor:pointer;display:inline-flex;align-items:center;gap:.5rem;transition:all .2s ease;margin-bottom:1.5rem}.btn-back[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#1a7f5a;color:#1a7f5a;transform:translate(-4px)}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.5rem;background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014}.header-icon-wrapper[_ngcontent-%COMP%]{width:48px;height:48px;background:#ecfdf5;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.header-icon[_ngcontent-%COMP%]{width:24px;height:24px;color:#1a7f5a}.header-text[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827;margin:0 0 .25rem}@media (min-width: 768px){.page-title[_ngcontent-%COMP%]{font-size:1.75rem}}.page-subtitle[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014}.loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;color:#1a7f5a;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:.95rem;color:#6b7280;font-weight:500;margin:0}.alert-error[_ngcontent-%COMP%]{padding:1rem 1.25rem;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;margin-bottom:1.5rem;display:flex;align-items:center;gap:.75rem;color:#991b1b;font-size:.9rem}.alert-icon[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014;padding:1.5rem}@media (min-width: 768px){.form-card[_ngcontent-%COMP%]{padding:2rem}}.form-section[_ngcontent-%COMP%]{margin-bottom:2rem;padding-bottom:2rem;border-bottom:2px solid #f3f4f6}.form-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none;margin-bottom:0;padding-bottom:0}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem}.section-badge[_ngcontent-%COMP%]{width:28px;height:28px;background:#1a7f5a;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.875rem;flex-shrink:0}@media (min-width: 768px){.section-badge[_ngcontent-%COMP%]{width:32px;height:32px;font-size:1rem}}.section-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin:0}@media (min-width: 768px){.section-title[_ngcontent-%COMP%]{font-size:1.25rem}}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.25rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.form-grid-full[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.85rem;font-weight:600;color:#374151}.label-icon[_ngcontent-%COMP%]{width:16px;height:16px;color:#6b7280;flex-shrink:0}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #d1d5db;border-radius:8px;font-size:.9rem;font-family:inherit;transition:all .2s ease}.form-input[_ngcontent-%COMP%]:hover, .form-select[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a7f5a;box-shadow:0 0 0 3px #1a7f5a14}.form-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.select-wrapper[_ngcontent-%COMP%]{position:relative}.select-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{appearance:none;cursor:pointer;width:100%}.select-icon[_ngcontent-%COMP%]{position:absolute;right:.875rem;top:50%;transform:translateY(-50%);width:16px;height:16px;color:#6b7280;pointer-events:none}.form-hint[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin:0;line-height:1.4}.radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}@media (min-width: 768px){.radio-group[_ngcontent-%COMP%]{flex-direction:row;gap:1.5rem}}.radio-option[_ngcontent-%COMP%]{flex:1;cursor:pointer}.radio-input[_ngcontent-%COMP%]{position:absolute;opacity:0;pointer-events:none}.radio-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;padding:1rem;border:2px solid #e5e7eb;border-radius:8px;transition:all .2s ease}.radio-option[_ngcontent-%COMP%]:hover   .radio-content[_ngcontent-%COMP%]{border-color:#1a7f5a;background:#f9fafb}.radio-selected[_ngcontent-%COMP%]   .radio-content[_ngcontent-%COMP%]{border-color:#1a7f5a;background:#ecfdf5}.radio-icon[_ngcontent-%COMP%]{width:24px;height:24px;flex-shrink:0;color:#9ca3af}.radio-selected[_ngcontent-%COMP%]   .radio-icon[_ngcontent-%COMP%]{color:#1a7f5a}.radio-text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.25rem}.radio-title[_ngcontent-%COMP%]{font-weight:600;color:#111827;font-size:.95rem}.radio-description[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.radio-selected[_ngcontent-%COMP%]   .radio-title[_ngcontent-%COMP%]{color:#1a7f5a}.form-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-top:2rem;padding-top:2rem;border-top:2px solid #f3f4f6}@media (min-width: 640px){.form-actions[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-end}}.btn-cancel[_ngcontent-%COMP%], .btn-save[_ngcontent-%COMP%]{padding:.875rem 1.5rem;border-radius:8px;font-weight:600;font-size:.95rem;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem;transition:all .2s ease;border:none}.btn-cancel[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.btn-cancel[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#111827}.btn-save[_ngcontent-%COMP%]{background:#1a7f5a;color:#fff}.btn-save[_ngcontent-%COMP%]:hover:not(:disabled){background:#166649}.btn-save[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.w-5[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (max-width: 639px){.editar-container[_ngcontent-%COMP%]{padding:.75rem}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.header-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center;padding:1.25rem}.header-icon-wrapper[_ngcontent-%COMP%]{margin:0 auto}.page-title[_ngcontent-%COMP%]{font-size:1.25rem}.form-card[_ngcontent-%COMP%]{padding:1.25rem}.form-section[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding-bottom:1.5rem}.section-header[_ngcontent-%COMP%]{margin-bottom:1rem}.form-grid[_ngcontent-%COMP%]{gap:1rem}.radio-group[_ngcontent-%COMP%]{gap:.75rem}.form-actions[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem}}"]})};export{A as EditarUsuarioComponent};
